load("C:/Users/danny/Documents/git/cusimano-rclass-project/Code/Processing_code/processingcode.R")
source("C:/Users/danny/Documents/git/cusimano-rclass-project/Code/Processing_code/processingcode.R")
require(tidyverse)
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
set.seed(123)
sample_n(ToothGrowth, 6)
res <- var.test(len ~ supp, data = ToothGrowth)
res
install.packages(Arothron)
rtools
devtools::install_github('SlicerMorph/SlicerMorphR')
'force = TRUE'
force = TRUE
devtools::install_github('SlicerMorph/SlicerMorphR')
# Code for importing tables
# I'm hoping that this will make for easy access
#Working directory setwd("C:/Users/danny/Documents/git/Research_Methods/Analysis")
## ---- Loadpackages --------
require(geomorph) #for GM analysis
require(SlicerMorphR) #for importing Slicer data
require(plyr) #for wireframe specs
require(dplyr) #for data processing/cleaning
require(tidyr) #for data processing/cleaning
require(skimr) #for nice visualization of data
require(knitr) #for qmd building
require(gapminder) #for plot aesthetics
## ---- loaddata --------
data_path <- "C:/Users/danny/Documents/git/Research_Methods/docs/"
## ---- Table1 --------
dictionary1 <- read.csv(paste(data_path, "Book1.csv", sep=""))
dictionary1 <- read.csv(paste(data_path, "Book1.csv", sep=""))
knitr::kable(dictionary1)
save_data_location_csv <- "../docs/Book1.csv"
write.csv(dictionary1, file = save_data_location_csv, row.names=FALSE)
save_data_location_csv <- "C:/Users/danny/Documents/git/Research_Methods/docs/Book1.csv"
write.csv(dictionary1, file = save_data_location_csv, row.names=FALSE)
install.packages("leaflet")
library(leaflet)
require(leaflet.providers)
library(leaflet.providers)
m <- leaflet()%>%
addTiles() %>%
addMarkers(lng = 109.92, lat = 34.77, popup = "Dali")
install.packages("dplyr")
require(dplyr)
m <- leaflet() %>%
addTiles() %>%
addMarkers(lng = 109.92, lat = 34.77, popup = "Dali")
install.packages("leaflet")
m <- leaflet() %>%
addTiles() %>%
addMarkers(lng = 109.92, lat = 34.77, popup = "Dali")
require(leaflet)
library(leaflet)
library(shiny)
library(leaflet.providers)
m <- leaflet() %>%
+     addTiles() %>%
+    addMarkers(lng = 109.92, lat = 34.77, popup = "Dali")
install.packages("leaflet")
library(leaflet)
?leaflet
??`leaflet.providers-package`
# Source - https://stackoverflow.com/a/70829399
# Posted by JaNith RathNayaka
# Retrieved 2026-01-29, License - CC BY-SA 4.0
RUN
sudo apt-get install libgdal-dev libproj-dev libgeos-dev libudunits2-dev netcdf-bin
install.packages("leaflet", dependencies = TRUE)
install.packages(sf)
install.packages("sf")
install.packages("units")
install.packages("leaflet", dependencies = TRUE)
install.packages("raster")
install.packages("terra")
install.packages("terra")
install.packages("leaflet")
install.packages("leaflet")
install.packages("leaflet", type ="source")
install.packages("pkgsearch")
install.packages(c("abind", "AlgDesign", "alphashape3d", "ape", "aplot", "AsioHeaders", "bayestestR", "BH", "BiocManager", "bit", "bit64", "blob", "brew", "brio", "broom", "bslib", "cachem", "callr", "candisc", "car", "checkmate", "chromote", "clusterGeneration", "coda", "colorspace", "commonmark", "corrplot", "corrr", "cowplot", "crayon", "credentials", "crosstalk", "crul", "data.table", "datawizard", "DBI", "dbplyr", "deldir", "dendextend", "desc", "DescTools", "deSolve", "devtools", "diffobj", "digest", "downlit", "dplyr", "DT", "dtplyr", "e1071", "effectsize", "ellipse", "emmeans", "entropy", "estimability", "Exact", "expm", "extrafont", "extrafontdb", "FactoMineR", "fansi", "farver", "fastmap", "fastmatch", "flextable", "fontawesome", "forcats", "fs", "gapminder", "gargle", "gclus", "gdtools", "geometry", "gert", "ggcorrplot", "ggfortify", "ggfun", "ggplot2", "ggplotify", "ggpubr", "ggrepel", "ggsci", "gh", "gld", "googledrive", "googlesheets4", "gtable", "haven", "heplots", "Hmisc", "hms", "htmlTable", "htmltools", "htmlwidgets", "httpuv", "httr", "httr2", "igraph", "insight", "interp", "isoband", "jpeg", "js", "jsonlite", "labeling", "later", "latticeExtra", "leaps", "linprog", "lme4", "lmom", "lpSolve", "lubridate", "magick", "manipulateWidget", "maps", "markdown", "MatrixModels", "miniUI", "minqa", "misc3d", "mnormt", "multcompView", "munsell", "mvtnorm", "nloptr", "officer", "pandoc", "parameters", "patchwork", "pbkrtest", "performance", "phangorn", "phytools", "pillar", "pkgbuild", "pkgdown", "pkgload", "plotrix", "prettyunits", "processx", "profvis", "progress", "promises", "proxy", "ps", "purrr", "quantreg", "ragg", "RANN", "rappdirs", "RcppEigen", "readr", "readxl", "rematch", "remotes", "rempsyc", "report", "repr", "reprex", "reshape", "reshape2", "rgl", "rlang", "rmarkdown", "rootSolve", "roxygen2", "rprojroot", "rstatix", "rstudioapi", "Rttf2pt1", "rversions", "rvest", "sass", "scales", "scatterplot3d", "selectr", "seriation", "sessioninfo", "shiny", "shinyjs", "skimr", "SparseM", "subplex", "systemfonts", "testthat", "textshaping", "tibble", "tidyr", "tidyselect", "tidytree", "tinytex", "tripack", "TSP", "tzdb", "urltools", "usethis", "utf8", "uuid", "V8", "vctrs", "viridis", "viridisLite", "vroom", "waldo", "webshot", "webshot2", "websocket", "withr", "xfun", "xopen", "yulab.utils", "zip"))
pkgsearch::pkg_search(query = "leaflet")
install.packages("leaflet")
install.packages("units")
install.packages("units", type = "binary")
install.packages("leaflet")
install.packages("xfun")
install.packages("mapview")
setOldClass(c("XYZ", "data.frame"))
install.packages("mapview")
m
setwd("C:/Users/danny/Documents/git/SiteMaps")
library(leaflet)
require(leaflet.providers)
library(dplyr)
require(knitr)
require(gapminder)
library(htmltools)
require(magrittr)
require(tidyr)
library(leaflegend)
require(skimr)
require(knitr)
require(RefManageR)
require(devtools)
require(flextable)
require(ftExtra)
require(officer)
coordsX <- read.csv(print("C:/Users/danny/Documents/git/SiteMaps/CalabrianWEA.csv"))
coords3 <- coordsX %>%select(-Country, -Ref.)
custom_div <- tags$div(
HTML("<h3>Custom Styled Div</h3><p>This is an absolutely positioned HTML element overlaying the map.</p>"),
style = "position: absolute;
top: 20px;
right: 20px;
z-index: 1000; /* Ensures the div is above map tiles but below some controls */
background-color: rgba(255, 255, 255, 0.8);
padding: 15px;
border-radius: 5px;
width: 200px;
box-shadow: 0 4px 8px rgba(0,0,0,0.1);"
)
symbols_list <- iconList(
diamond = makeSymbol(shape = 'diamond', color = 'black', fillColor = 'black', opacity = 1, width = 10),
star    = makeSymbol(shape = 'star',    color = 'black', fillColor = 'black', opacity = 1, width = 10)
)
symbols_list <- list(
diamond = makeSymbol(shape = 'diamond', color = 'black', fillColor = 'black', opacity = 1, width = 10),
star    = makeSymbol(shape = 'star',    color = 'black', fillColor = 'black', opacity = 1, width = 10)
)
class(symbols_list) <- "leaflet_icon_set"
f <- leaflet(data = coords3)|> addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(~Lng, ~Lat,
popup = paste("Site:", coords3$Site, "<br>",
"Age:", coords3$Proposed.Absolute.Age),
icon = ~symbols_list[ifelse(!is.na(`Hominin Fossils`) & `Hominin Fossils` != "", "star", "diamond")],
label = ~Number,
labelOptions = labelOptions(noHide = TRUE, textOnly = TRUE, direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold")
))
f <- leaflet(data = coords3)|> addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(~Lng, ~Lat,
popup = paste("Site:", coords3$Site, "<br>",
"Age:", coords3$Proposed.Absolute.Age),
icon = ~symbols_list[ifelse(!is.na("Hominin Fossils") & "Hominin Fossils" != "", "star", "diamond")],
label = ~Number,
labelOptions = labelOptions(noHide = TRUE, textOnly = TRUE, direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold")
))
colnames(coords3)
f <- leaflet(data = coords3)|> addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(~Lng, ~Lat,
popup = paste("Site:", coords3$Site, "<br>",
"Age:", coords3$Proposed.Absolute.Age),
icon = ~symbols_list[ifelse(!is.na(`Hominin.Fossils`) & `Hominin.Fossils` != "", "star", "diamond")],
label = ~Number,
labelOptions = labelOptions(noHide = TRUE, textOnly = TRUE, direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold")
))
f <- leaflet(data = coords3)|> addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(~Lng, ~Lat,
popup = paste("Site:", coords3$Site, "<br>",
"Age:", coords3$Proposed.Absolute.Age),
icon = ~symbols_list[ifelse(!is.na(Hominin.Fossils) & Hominin.Fossils != "", "star", "diamond")],
label = ~Number,
labelOptions = labelOptions(noHide = TRUE, textOnly = TRUE, direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold")
))
f <- leaflet(data = coords3) |>
addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(
lng = ~Lng,
lat = ~Lat,
# Use ~ without the $ for popup fields
popup = ~paste("Site:", Site, "<br>", "Age:", Proposed.Absolute.Age),
# Ensure this column name exactly matches colnames(coords3)
icon = ~symbols_list[ifelse(!is.na(Hominin.Fossils) & Hominin.Fossils != "", "star", "diamond")],
label = ~Number,
labelOptions = labelOptions(
noHide = TRUE,
textOnly = TRUE,
direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold"
)
) # Added missing closing parenthesis for labelOptions
) # Added missing closing parenthesis for addMarkers
icon = ~symbols_list[ifelse(
!is.na(Hominin.Fossils) & Hominin.Fossils != "" & Hominin.Fossils != "NA",
"star",
"diamond"
)]
f <- leaflet(data = coords3)|> addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(~Lng, ~Lat,
popup = paste("Site:", coords3$Site, "<br>",
"Age:", coords3$Proposed.Absolute.Age),
icon = ~symbols_list[ifelse(!is.na(Hominin.Fossils) & Hominin.Fossils != "", "star", "diamond")],
label = ~Number,
labelOptions = labelOptions(noHide = TRUE, textOnly = TRUE, direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold")
))
icon = ~symbols_list[ifelse(
!is.na(Hominin.Fossils) & Hominin.Fossils != "" & Hominin.Fossils != "NA",
"star",
"diamond"
)]
f <- leaflet(data = coords3) |>
addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(
lng = ~Lng,
lat = ~Lat,
# Use ~ without the $ for popup fields
popup = ~paste("Site:", Site, "<br>", "Age:", Proposed.Absolute.Age),
# Ensure this column name exactly matches colnames(coords3)
icon = ~symbols_list[ifelse(!is.na(Hominin.Fossils) & Hominin.Fossils != "", "star", "diamond")],
label = ~Number,
labelOptions = labelOptions(
noHide = TRUE,
textOnly = TRUE,
direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold"
)
) # Added missing closing parenthesis for labelOptions
) # Added missing closing parenthesis for addMarkers
coords3$icon_type <- ifelse(
is.na(coords3$Hominin.Fossils) | coords3$Hominin.Fossils == "" | coords3$Hominin.Fossils == "NA",
"diamond",
"star"
)
coords3$icon_type[is.na(coords3$icon_type)] <- "diamond"
f <- leaflet(data = coords3) |>
addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(
lng = ~Lng,
lat = ~Lat,
popup = ~paste("Site:", Site, "<br>", "Age:", Proposed.Absolute.Age),
# Use the new pre-calculated column here
icon = ~symbols_list[icon_type],
label = ~Number,
labelOptions = labelOptions(
noHide = TRUE,
textOnly = TRUE,
direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold"
)
)
)
f <- leaflet(data = coords3)|> addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(~Lng, ~Lat,
popup = paste("Site:", coords3$Site, "<br>",
"Age:", coords3$Proposed.Absolute.Age),
icon = ~symbols_list[[ifelse(!is.na(Hominin.Fossils) & Hominin.Fossils != "", "star", "diamond")]],
label = ~Number,
labelOptions = labelOptions(noHide = TRUE, textOnly = TRUE, direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold")
))
# 1. Re-create the icon set correctly
symbols_list <- list(
diamond = makeSymbol(shape = 'diamond', color = 'black', fillColor = 'black', opacity = 1, width = 10),
star    = makeSymbol(shape = 'star',    color = 'black', fillColor = 'black', opacity = 1, width = 10)
)
class(symbols_list) <- "leaflet_icon_set"
# 2. Create a clean column in your data with NO spaces or NAs
coords3$icon_type <- ifelse(
!is.na(coords3$Hominin.Fossils) & coords3$Hominin.Fossils != "" & coords3$Hominin.Fossils != "NA",
"star",
"diamond"
)
# 3. Build the map using the column name as the index
f <- leaflet(data = coords3) |>
addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(
lng = ~Lng,
lat = ~Lat,
popup = ~paste("Site:", Site, "<br>", "Age:", Proposed.Absolute.Age),
# IMPORTANT: Use [ ] with the tilde ~, not [[ ]]
icon = ~symbols_list[icon_type],
label = ~Number,
labelOptions = labelOptions(
noHide = TRUE, textOnly = TRUE, direction = 'left', offset = c(-2, -2),
style = list("color" = "black", "font-family" = "serif", "font-size" = "16px", "font-weight" = "bold")
)
)
names(symbols_list)
unique(coords3$icon_type)
class(symbols_list)
coords3$safe_icon <- ifelse(
!is.na(coords3$Hominin.Fossils) & coords3$Hominin.Fossils %in% c("Yes", "TRUE", "star"),
"star",
"diamond"
)
f <- leaflet(data = coords3)|> addTiles() |>
addProviderTiles(providers$Esri.WorldPhysical) |>
addMarkers(~Lng, ~Lat,
popup = paste("Site:", coords3$Site, "<br>",
"Age:", coords3$Proposed.Absolute.Age),
icon = ~symbols_list[safe_icon],
label = ~Number,
labelOptions = labelOptions(noHide = TRUE, textOnly = TRUE, direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold")
))
symbols_list <- list(
diamond = makeSymbol(shape = 'diamond', color = 'black', fillColor = 'black', opacity = 1, width = 10),
star    = makeSymbol(shape = 'star',    color = 'black', fillColor = 'black', opacity = 1, width = 10)
)
class(symbols_list) <- "leaflet_icon_set"
# 2. PREPARE THE DATA (The "Safety Column")
# We create 'icon_type' outside the map to ensure it only contains 'star' or 'diamond'
# This prevents the "subscript out of bounds" error caused by NAs or empty strings
coords3$icon_type <- ifelse(
!is.na(coords3$Hominin.Fossils) & coords3$Hominin.Fossils != "" & coords3$Hominin.Fossils != "NA",
"star",
"diamond"
)
# Safety check: Force any unexpected remaining NAs to be 'diamond'
coords3$icon_type[is.na(coords3$icon_type)] <- "diamond"
# 3. BUILD THE MAP
f <- leaflet(data = coords3) %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldPhysical) %>%
addMarkers(
lng = ~Lng,
lat = ~Lat,
# Using ~ with [ ] and the pre-cleaned column
icon = ~symbols_list[icon_type],
popup = ~paste(
"<b>Site:</b>", Site, "<br>",
"<b>Age:</b>", Proposed.Absolute.Age
),
label = ~as.character(Number),
labelOptions = labelOptions(
noHide = TRUE,
textOnly = TRUE,
direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold"
)
)
)
f
symbols_list <- list(
diamond = makeSymbol(shape = 'diamond', color = 'black', fillColor = 'black', opacity = 1, width = 10),
star    = makeSymbol(shape = 'star',    color = 'black', fillColor = 'black', opacity = 1, width = 10)
)
# REQUIRED: Manually set the class for leaflegend symbols
class(symbols_list) <- "leaflet_icon_set"
# 2. PREPARE THE DATA (The "Safety Column")
# Create a dedicated column for the icon keys
coords3$icon_type <- ifelse(
!is.na(coords3$Hominin.Fossils) & coords3$Hominin.Fossils != "" & coords3$Hominin.Fossils != "NA",
"star",
"diamond"
)
# Safety check: Force any NAs to 'diamond'
coords3$icon_type[is.na(coords3$icon_type)] <- "diamond"
# 3. BUILD THE MAP
f <- leaflet(data = coords3) %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldPhysical) %>%
addMarkers(
lng = ~Lng,
lat = ~Lat,
# FIX: Wrap the column in as.character() to prevent 'out of bounds' numeric errors
icon = ~symbols_list[as.character(icon_type)],
popup = ~paste(
"<b>Site:</b>", Site, "<br>",
"<b>Age:</b>", Proposed.Absolute.Age
),
label = ~as.character(Number),
labelOptions = labelOptions(
noHide = TRUE,
textOnly = TRUE,
direction = 'left',
offset = c(-2, -2),
style = list(
"color" = "black",
"font-family" = "serif",
"font-size" = "16px",
"font-weight" = "bold"
)
)
)
symbols_list <- list(
diamond = makeSymbol(shape = 'diamond', color = 'black', fillColor = 'black', opacity = 1, width = 10),
star    = makeSymbol(shape = 'star',    color = 'black', fillColor = 'black', opacity = 1, width = 10)
)
# This class is mandatory for leaflegend objects to work in addMarkers
class(symbols_list) <- "leaflet_icon_set"
# 2. CLEAN DATA AND REMOVE FACTORS
# We ensure the column is plain text (character) and handle all missing data types
coords3$icon_type <- as.character(ifelse(
!is.na(coords3$Hominin.Fossils) & coords3$Hominin.Fossils != "" & coords3$Hominin.Fossils != "NA",
"star",
"diamond"
))
coords3$icon_type[is.na(coords3$icon_type)] <- "diamond"
# 3. BUILD THE MAP
f <- leaflet(data = coords3) %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldPhysical) %>%
addMarkers(
lng = ~Lng,
lat = ~Lat,
# Use unname() to strip any remaining factor levels or attributes
icon = ~symbols_list[unname(as.character(icon_type))],
popup = ~paste("<b>Site:</b>", Site, "<br>", "<b>Age:</b>", Proposed.Absolute.Age),
label = ~as.character(Number),
labelOptions = labelOptions(
noHide = TRUE, textOnly = TRUE, direction = 'left', offset = c(-2, -2),
style = list("color" = "black", "font-family" = "serif", "font-size" = "16px", "font-weight" = "bold")
)
)
symbols_list <- list(
diamond = makeSymbol(shape = 'diamond', color = 'black', fillColor = 'black', width = 10),
star    = makeSymbol(shape = 'star',    color = 'black', fillColor = 'black', width = 10)
)
class(symbols_list) <- "leaflet_icon_set"
# 2. PREPARE DATA
# Create a clean column that ONLY contains "star" or "diamond"
coords3$icon_type <- ifelse(
!is.na(coords3$Hominin.Fossils) & coords3$Hominin.Fossils != "" & coords3$Hominin.Fossils != "NA",
"star",
"diamond"
)
coords3$icon_type[is.na(coords3$icon_type)] <- "diamond"
# 3. DEFINE A LOOKUP FUNCTION (This prevents the "out of bounds" error)
get_icon <- function(type) {
symbols_list[type]
}
# 4. BUILD THE MAP
f <- leaflet(data = coords3) %>%
addTiles() %>%
addProviderTiles(providers$Esri.WorldPhysical) %>%
addMarkers(
lng = ~Lng,
lat = ~Lat,
# Use the function instead of direct list indexing
icon = ~get_icon(icon_type),
popup = ~paste("<b>Site:</b>", Site, "<br>", "<b>Age:</b>", Proposed.Absolute.Age),
label = ~as.character(Number),
labelOptions = labelOptions(
noHide = TRUE, textOnly = TRUE, direction = 'left', offset = c(-2, -2),
style = list("color" = "black", "font-family" = "serif", "font-size" = "16px", "font-weight" = "bold")
)
)
